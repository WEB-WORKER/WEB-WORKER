<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Распознавание голоса и чтение текста</title>
</head>
<body>

  <button onclick="speech ()">Слушать</button>
  <button onclick="talk ()">Проговорить</button>
  <button onclick="stop ()">Остановить</button>
  <div id="cont">    
  </div>

  <script>
  // Создаем распознаватель
  var recognizer = new webkitSpeechRecognition();
  
  //тип распознавания длительный
  recognizer.continuous = true;
  // Ставим опцию, чтобы распознавание началось ещё до того, как пользователь закончит говорить
  recognizer.interimResults = true;
  // Какой язык будем распознавать?
  recognizer.lang = 'ru-Ru';
  
  var superarr = [],
      arr = [],
      str,
      i = 0;
    
  superarr[0] = [1];  
    
  // Используем колбек для обработки результатов
  recognizer.onresult = function (event) {
    var result = event.results[event.resultIndex];   
    
    
    
    if (result.isFinal) {            
        arr.push(result[0].transcript);
        document.getElementById('cont').innerHTML = arr;
        str = arr.join();
        console.log('Массив:', arr);             
    } else {
      if((result[0].transcript).toLowerCase().indexOf("следующий файл") > 0){
        console.log("получилось!");
        i = i + 1;
        console.log(i);
        superarr[i] = arr;
        arr = 0;
      } else {  
          console.log('Промежуточный результат: ', result[0].transcript);      
      }
    }
    console.log(superarr);
    document.getElementById('cont').innerHTML = str;
  };
  function speech () {
    // Начинаем слушать микрофон и распознавать голос
    recognizer.start();
  }
  var synth = window.speechSynthesis;
  var utterance = new SpeechSynthesisUtterance('How about we say this now? This is quite a long sentence to say.');
  function talk () {
    synth.speak (utterance);
  }
  function stop () {
    synth.pause();
  }
  </script>

</body>
</html>
